---
layout: vimdoc
helpname: 'usr_50'
---
<div id='vimCodeElement'>
<a class="Constant" href="usr_50.html" name="usr_50.txt">usr_50.txt</a>&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;<span class="Identifier">Vim version 8.2.</span>&nbsp;&nbsp;Last change: 2022 Jun 03<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VIM USER MANUAL - by Bram Moolenaar<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Advanced Vim script writing<br>
<br>
<br>
<a class="Identifier" href="usr_50.html#50.1">50.1</a>&nbsp;&nbsp;Exceptions<br>
<a class="Identifier" href="usr_50.html#50.2">50.2</a>&nbsp;&nbsp;&nbsp;&nbsp;Function with variable number of arguments<br>
<a class="Identifier" href="usr_50.html#50.3">50.3</a>&nbsp;&nbsp;Restoring the view<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp; Next chapter:&nbsp;<a class="Identifier" href="usr_51.html">usr_51.txt</a>&nbsp;&nbsp;Create a plugin<br>
&nbsp;Previous chapter:&nbsp;<a class="Identifier" href="usr_45.html">usr_45.txt</a>&nbsp;&nbsp;Select your language (local)<br>
Table of contents:&nbsp;<a class="Identifier" href="usr_toc.html">usr_toc.txt</a><br>
<br>
<span class="PreProc">==============================================================================</span><br>
<a class="Constant" href="usr_50.html#50.1" name="50.1">50.1</a>&nbsp;&nbsp;Exceptions<br>
<br>
Let's start with an example:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; read ~/templates/pascal.tmpl<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch /E484:/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &quot;Sorry, the Pascal template file cannot be found.&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endtry</div>
<br>
The&nbsp;<a class="Comment" href="insert.html#:read">read</a>&nbsp;command will fail if the file does not exist.&nbsp;&nbsp;Instead of<br>
generating an error message, this code catches the error and gives the user a<br>
message with more information.<br>
<br>
For the commands in between&nbsp;<a class="Comment" href="eval.html#:try">try</a>&nbsp;and&nbsp;<a class="Comment" href="eval.html#:endtry">endtry</a>&nbsp;errors are turned into<br>
exceptions.&nbsp;&nbsp;An exception is a string.&nbsp;&nbsp;In the case of an error the string<br>
contains the error message.&nbsp;&nbsp;And every error message has a number.&nbsp;&nbsp;In this<br>
case, the error we catch contains &quot;E484:&quot;.&nbsp;&nbsp;This number is guaranteed to stay<br>
the same (the text may change, e.g., it may be translated).<br>
<br>
Besides being able to give a nice error message, Vim will also continue<br>
executing commands after the&nbsp;<a class="Comment" href="eval.html#:endtry">:endtry</a>.&nbsp;&nbsp;Otherwise, once an uncaught error is<br>
encountered, execution of the script/function/mapping will be aborted.<br>
<br>
When the&nbsp;<a class="Comment" href="insert.html#:read">read</a>&nbsp;command causes another error, the pattern &quot;E484:&quot; will not<br>
match in it.&nbsp;&nbsp;Thus this exception will not be caught and result in the usual<br>
error message and execution is aborted.<br>
<br>
You might be tempted to do this:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; read ~/templates/pascal.tmpl<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo &quot;Sorry, the Pascal template file cannot be found.&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endtry</div>
<br>
This means all errors are caught.&nbsp;&nbsp;But then you will not see an error that<br>
would indicate a completely different problem, such as &quot;E21: Cannot make<br>
changes,&nbsp;<a class="Type" href="options.html#'modifiable'">'modifiable'</a>&nbsp;is off&quot;.&nbsp;&nbsp;Think twice before you catch any error!<br>
<br>
Another useful mechanism is the&nbsp;<a class="Comment" href="eval.html#:finally">finally</a>&nbsp;command:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var tmp = tempname()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exe &quot;:.,$write &quot; .. tmp<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exe &quot;!filter &quot; .. tmp<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :.,$delete<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exe &quot;:$read &quot; .. tmp<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;finally<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delete(tmp)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endtry</div>
<br>
This filters the lines from the cursor until the end of the file through the<br>
&quot;filter&quot; command, which takes a file name argument.&nbsp;&nbsp;No matter if the<br>
filtering works, if something goes wrong in between&nbsp;<a class="Comment" href="eval.html#:try">try</a>&nbsp;and&nbsp;<a class="Comment" href="eval.html#:finally">finally</a>&nbsp;or the<br>
user cancels the filtering by pressing&nbsp;<span class="Special">CTRL-C</span>, the&nbsp;<span class="Comment">delete(tmp)</span>&nbsp;call is<br>
always executed.&nbsp;&nbsp;This makes sure you don't leave the temporary file behind.<br>
<br>
The&nbsp;<a class="Comment" href="eval.html#:finally">finally</a>&nbsp;does not catch the exception, the error will still abort<br>
further execution.<br>
<br>
More information about exception handling can be found in the reference<br>
manual:&nbsp;<a class="Identifier" href="eval.html#exception-handling">exception-handling</a>.<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<a class="Constant" href="usr_50.html#50.2" name="50.2">50.2</a>&nbsp;&nbsp;Function with variable number of arguments<br>
<br>
Vim enables you to define functions that have a variable number of arguments.<br>
The following command, for instance, defines a function that must have 1<br>
argument (start) and can have up to 20 additional arguments:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def Show(start: string, ...items: list&lt;string&gt;)</div>
<br>
The variable &quot;items&quot; will be a list in the function containing the extra<br>
arguments.&nbsp;&nbsp;You can use it like any list, for example:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def Show(start: string, ...items: list&lt;string&gt;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echohl Title<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &quot;start is &quot; .. start<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echohl None<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for index in range(len(items))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echon $&quot;&nbsp;&nbsp;Arg {index} is {items[index]}&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endfor<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddef</div>
<br>
You can call it like this:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Show('Title', 'one', 'two', 'three')</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">start is Title&nbsp;&nbsp;Arg 0 is one&nbsp;&nbsp;Arg 1 is two&nbsp;&nbsp;Arg 2 is three</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
This uses the&nbsp;<a class="Comment" href="eval.html#:echohl">echohl</a>&nbsp;command to specify the highlighting used for the<br>
following&nbsp;<a class="Comment" href="eval.html#:echo">echo</a>&nbsp;command.&nbsp;&nbsp;<span class="Comment">echohl None</span>&nbsp;stops it again.&nbsp;&nbsp;The&nbsp;<a class="Comment" href="eval.html#:echon">echon</a>&nbsp;command<br>
works like&nbsp;<a class="Comment" href="eval.html#:echo">echo</a>, but doesn't output a line break.<br>
<br>
If you call it with one argument the &quot;items&quot; list will be empty.<br>
<span class="Comment">range(len(items))</span>&nbsp;returns a list with the indexes, what&nbsp;<a class="Comment" href="eval.html#:for">for</a>&nbsp;loops over,<br>
we'll explain that further down.<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<a class="Constant" href="usr_50.html#50.3" name="50.3">50.3</a>&nbsp;&nbsp;Restoring the view<br>
<br>
Sometimes you want to make a change and go back to where the cursor was.<br>
Restoring the relative position would also be nice, so that the same line<br>
appears at the top of the window.<br>
<br>
This example yanks the current line, puts it above the first line in the file<br>
and then restores the view:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map ,p ma&quot;aYHmbgg&quot;aP`bzt`a</div>
<br>
What this does:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ma&quot;aYHmbgg&quot;aP`bzt`a</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ma&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set mark a at cursor position<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;aY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; yank current line into register a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Hmb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;go to top line in window and set mark b there<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;go to first line in file<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;aP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; put the yanked line above it<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; `b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; go back to top line in display<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; zt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; position the text in the window as before<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; `a&nbsp;&nbsp;&nbsp;&nbsp; go back to saved cursor position<br>
<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<br>
Next chapter:&nbsp;<a class="Identifier" href="usr_51.html">usr_51.txt</a>&nbsp;&nbsp;Create a plugin<br>
<br>
Copyright: see&nbsp;<a class="Identifier" href="usr_01.html#manual-copyright">manual-copyright</a>&nbsp;&nbsp;vim:tw=78:ts=8:noet:ft=help:norl:<br>
</div>
