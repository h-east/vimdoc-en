---
layout: vimdoc
helpname: 'vim9class'
---
<div id='vimCodeElement'>
<a class="Constant" href="vim9class.html" name="vim9class.txt">vim9class.txt</a>&nbsp;For&nbsp;<span class="Identifier">Vim version 9.0.</span>&nbsp;&nbsp;Last change: 2023 Dec 28<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Identifier">VIM REFERENCE MANUAL&nbsp;&nbsp;&nbsp;&nbsp;by Bram Moolenaar</span><br>
<br>
<br>
Vim9 classes, objects, interfaces, types and enums.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#vim9-class" name="vim9-class">vim9-class</a><br>
<br>
1.&nbsp;&nbsp;Overview&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="vim9class.html#Vim9-class-overview">Vim9-class-overview</a><br>
2.&nbsp;&nbsp;A simple class&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="vim9class.html#Vim9-simple-class">Vim9-simple-class</a><br>
3.&nbsp;&nbsp;Class variables and methods&nbsp;<a class="Identifier" href="vim9class.html#Vim9-class-member">Vim9-class-member</a><br>
4.&nbsp;&nbsp;Using an abstract class&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="vim9class.html#Vim9-abstract-class">Vim9-abstract-class</a><br>
5.&nbsp;&nbsp;Using an interface&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="vim9class.html#Vim9-using-interface">Vim9-using-interface</a><br>
6.&nbsp;&nbsp;More class details&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="vim9class.html#Vim9-class">Vim9-class</a><br>
7.&nbsp;&nbsp;Type definition&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="vim9class.html#Vim9-type">Vim9-type</a><br>
8.&nbsp;&nbsp;Enum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="vim9class.html#Vim9-enum">Vim9-enum</a><br>
<br>
9.&nbsp;&nbsp;Rationale<br>
10. To be done later<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<br>
1. Overview&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#Vim9-class-overview" name="Vim9-class-overview">Vim9-class-overview</a><br>
<br>
The fancy term is &quot;object-oriented programming&quot;.&nbsp;&nbsp;You can find lots of study<br>
material on this subject.&nbsp;&nbsp;Here we document what&nbsp;<a class="Identifier" href="vim9.html#Vim9">Vim9</a>&nbsp;script provides,<br>
assuming you know the basics already.&nbsp;&nbsp;Added are helpful hints about how to<br>
use this functionality effectively.&nbsp;&nbsp;Vim9 classes and objects cannot be used<br>
in legacy Vim scripts and legacy functions.<br>
<br>
The basic item is an object:<br>
- An object stores state.&nbsp;&nbsp;It contains one or more variables that can each<br>
&nbsp;&nbsp;have a value.<br>
- An object provides functions that use and manipulate its state.&nbsp;&nbsp;These<br>
&nbsp;&nbsp;functions are invoked &quot;on the object&quot;, which is what sets it apart from the<br>
&nbsp;&nbsp;traditional separation of data and code that manipulates the data.<br>
- An object has a well defined interface, with typed member variables and<br>
&nbsp;&nbsp;methods.<br>
- Objects are created from a class and all objects have the same interface.<br>
&nbsp;&nbsp;This does not change at runtime, it is not dynamic.<br>
<br>
An object can only be created by a class.&nbsp;&nbsp;A class provides:<br>
- A new() method, the constructor, which returns an object for the class.<br>
&nbsp;&nbsp;This method is invoked on the class name: MyClass.new().<br>
- State shared by all objects of the class: class variables (class members).<br>
- A hierarchy of classes, with super-classes and sub-classes, inheritance.<br>
<br>
An interface is used to specify properties of an object:<br>
- An object can declare several interfaces that it implements.<br>
- Different objects implementing the same interface can be used the same way.<br>
<br>
The class hierarchy allows for single inheritance.&nbsp;&nbsp;Otherwise interfaces are<br>
to be used where needed.<br>
<br>
<br>
<span class="PreProc">Class modeling</span><br>
<br>
You can model classes any way you like.&nbsp;&nbsp;Keep in mind what you are building,<br>
don't try to model the real world.&nbsp;&nbsp;This can be confusing, especially because<br>
teachers use real-world objects to explain class relations and you might think<br>
your model should therefore reflect the real world.&nbsp;&nbsp;It doesn't!&nbsp;&nbsp;The model<br>
should match your purpose.<br>
<br>
Keep in mind that composition (an object contains other objects) is often<br>
better than inheritance (an object extends another object).&nbsp;&nbsp;Don't waste time<br>
trying to find the optimal class model.&nbsp;&nbsp;Or waste time discussing whether a<br>
square is a rectangle or that a rectangle is a square.&nbsp;&nbsp;It doesn't matter.<br>
<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<br>
2.&nbsp;&nbsp;A simple class&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#Vim9-simple-class" name="Vim9-simple-class">Vim9-simple-class</a><br>
<br>
Let's start with a simple example: a class that stores a text position (see<br>
below for how to do this more efficiently):<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class TextPosition<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var lnum: number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var col: number</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def new(lnum: number, col: number)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.lnum = lnum<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.col = col<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enddef</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def SetLnum(lnum: number)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.lnum = lnum<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enddef</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def SetCol(col: number)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.col = col<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enddef</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def SetPosition(lnum: number, col: number)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.lnum = lnum<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.col = col<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; endclass</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#object" name="object">object</a>&nbsp;<a class="Constant" href="vim9class.html#Object" name="Object">Object</a><br>
You can create an object from this class with the new() method:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var pos = TextPosition.new(1, 1)</div>
<br>
The object variables &quot;lnum&quot; and &quot;col&quot; can be accessed directly:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo $'The text position is ({pos.lnum}, {pos.col})'</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1317" name="E1317">E1317</a>&nbsp;<a class="Constant" href="vim9class.html#E1327" name="E1327">E1327</a><br>
If you have been using other object-oriented languages you will notice that in<br>
Vim, within a class definition, the object members are consistently referred<br>
to with the &quot;this.&quot; prefix.&nbsp;&nbsp;This is different from languages like Java and<br>
TypeScript.&nbsp;&nbsp;The naming convention makes the object members easy to spot.<br>
Also, when a variable does not have the &quot;this.&quot; prefix you know it is not an<br>
object variable.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1411" name="E1411">E1411</a><br>
From outside the class definition, access an object's methods and variables by<br>
using the object name followed by a dot following by the member:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos.lnum<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos.setCol(10)</div>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1405" name="E1405">E1405</a>&nbsp;<a class="Constant" href="vim9class.html#E1406" name="E1406">E1406</a><br>
A class name cannot be used as an expression.&nbsp;&nbsp;A class name cannot be used in<br>
the left-hand-side of an assignment.<br>
<br>
<br>
<span class="PreProc">Object variable write access</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#read-only-variable" name="read-only-variable">read-only-variable</a><br>
Now try to change an object variable directly:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos.lnum = 9</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1335" name="E1335">E1335</a><br>
This will give you an error!&nbsp;&nbsp;That is because by default object variables can<br>
be read but not set.&nbsp;&nbsp;That's why the TextPosition class provides a method for<br>
it:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos.SetLnum(9)</div>
<br>
Allowing to read but not set an object variable is the most common and safest<br>
way.&nbsp;&nbsp;Most often there is no problem using a value, while setting a value may<br>
have side effects that need to be taken care of.&nbsp;&nbsp;In this case, the SetLnum()<br>
method could check if the line number is valid and either give an error or use<br>
the closest valid value.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#:public" name=":public">:public</a>&nbsp;<a class="Constant" href="vim9class.html#public-variable" name="public-variable">public-variable</a>&nbsp;<a class="Constant" href="vim9class.html#E1331" name="E1331">E1331</a><br>
If you don't care about side effects and want to allow the object variable to<br>
be changed at any time, you can make it public:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public var lnum: number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public var col: number</div>
<br>
Now you don't need the SetLnum(), SetCol() and SetPosition() methods, setting<br>
&quot;pos.lnum&quot; directly above will no longer give an error.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1326" name="E1326">E1326</a><br>
If you try to set an object variable that doesn't exist you get an error:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos.other = 9</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="PreProc">E1326: Member not found on object &quot;TextPosition&quot;: other</span><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1376" name="E1376">E1376</a><br>
A object variable cannot be accessed using the class name.<br>
<br>
<span class="PreProc">Protected variables</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#protected-variable" name="protected-variable">protected-variable</a>&nbsp;<a class="Constant" href="vim9class.html#E1332" name="E1332">E1332</a>&nbsp;<a class="Constant" href="vim9class.html#E1333" name="E1333">E1333</a><br>
On the other hand, if you do not want the object variables to be read directly<br>
from outside the class or its sub-classes, you can make them protected.&nbsp;&nbsp;This<br>
is done by prefixing an underscore to the name:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var _lnum: number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var _col number</div>
<br>
Now you need to provide methods to get the value of the protected variables.<br>
These are commonly called getters.&nbsp;&nbsp;We recommend using a name that starts with<br>
&quot;Get&quot;:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def GetLnum(): number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return this._lnum<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddef</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def GetCol() number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return this._col<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddef</div>
<br>
This example isn't very useful, the variables might as well have been public.<br>
It does become useful if you check the value.&nbsp;&nbsp;For example, restrict the line<br>
number to the total number of lines:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def GetLnum(): number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if this._lnum &gt; this._lineCount<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return this._lineCount<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; endif<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return this._lnum<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddef</div>
<br>
<span class="PreProc">Protected methods</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#protected-method" name="protected-method">protected-method</a>&nbsp;<a class="Constant" href="vim9class.html#E1366" name="E1366">E1366</a><br>
If you want object methods to be accessible only from other methods of the<br>
same class and not used from outside the class, then you can make them<br>
protected.&nbsp;&nbsp;This is done by prefixing the method name with an underscore:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;class SomeClass<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def _Foo(): number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def Bar(): number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return this._Foo()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
Accessing a protected method outside the class will result in an error (using<br>
the above class):<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;var a = SomeClass.new()<br>
&nbsp;&nbsp;&nbsp;&nbsp;a._Foo()</div>
<br>
<span class="PreProc">Simplifying the new() method</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#new()" name="new()">new()</a>&nbsp;<a class="Constant" href="vim9class.html#constructor" name="constructor">constructor</a><br>
See also&nbsp;<a class="Identifier" href="vim9class.html#default-constructor">default-constructor</a>&nbsp;and&nbsp;<a class="Identifier" href="vim9class.html#multiple-constructors">multiple-constructors</a>.<br>
<br>
Many constructors take values for the object variables.&nbsp;&nbsp;Thus you very often<br>
see this pattern:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; class SomeClass<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var lnum: number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var col: number</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def new(lnum: number, col: number)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.lnum = lnum<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.col = col<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; endclass</div>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1390" name="E1390">E1390</a><br>
Not only is this text you need to write, it also has the type of each<br>
variable twice.&nbsp;&nbsp;Since this is so common a shorter way to write new() is<br>
provided:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def new(this.lnum, this.col)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enddef</div>
<br>
The semantics are easy to understand: Providing the object variable name,<br>
including &quot;this.&quot;, as the argument to new() means the value provided in the<br>
new() call is assigned to that object variable.&nbsp;&nbsp;This mechanism comes from the<br>
Dart language.<br>
<br>
Putting together this way of using new() and making the variables public<br>
results in a much shorter class definition than what we started with:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class TextPosition<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public var lnum: number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public var col: number</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def new(this.lnum, this.col)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enddef</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def SetPosition(lnum: number, col: number)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.lnum = lnum<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.col = col<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; endclass</div>
<br>
The sequence of constructing a new object is:<br>
1. Memory is allocated and cleared.&nbsp;&nbsp;All values are zero/false/empty.<br>
2. For each declared object variable that has an initializer, the expression<br>
&nbsp;&nbsp; is evaluated and assigned to the variable.&nbsp;&nbsp;This happens in the sequence<br>
&nbsp;&nbsp; the variables are declared in the class.<br>
3. Arguments in the new() method in the &quot;this.name&quot; form are assigned.<br>
4. The body of the new() method is executed.<br>
<br>
If the class extends a parent class, the same thing happens.&nbsp;&nbsp;In the second<br>
step the object variables of the parent class are initialized first.&nbsp;&nbsp;There is<br>
no need to call &quot;super()&quot; or &quot;new()&quot; on the parent.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1365" name="E1365">E1365</a><br>
When defining the new() method the return type should not be specified.&nbsp;&nbsp;It<br>
always returns an object of the class.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1386" name="E1386">E1386</a><br>
When invoking an object method, the method name should be preceded by the<br>
object variable name.&nbsp;&nbsp;An object method cannot be invoked using the class<br>
name.<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<br>
3.&nbsp;&nbsp;Class Variables and Methods&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#Vim9-class-member" name="Vim9-class-member">Vim9-class-member</a><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#:static" name=":static">:static</a>&nbsp;<a class="Constant" href="vim9class.html#E1337" name="E1337">E1337</a>&nbsp;<a class="Constant" href="vim9class.html#E1338" name="E1338">E1338</a>&nbsp;<a class="Constant" href="vim9class.html#E1368" name="E1368">E1368</a><br>
Class members are declared with &quot;static&quot;.&nbsp;&nbsp;They are used by the name without a<br>
prefix in the class where they are defined:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class OtherThing<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var size: number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static var totalSize: number</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def new(this.size)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;totalSize += this.size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1340" name="E1340">E1340</a>&nbsp;<a class="Constant" href="vim9class.html#E1341" name="E1341">E1341</a><br>
Since the name is used as-is, shadowing the name by a method argument name<br>
or local variable name is not allowed.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1374" name="E1374">E1374</a>&nbsp;<a class="Constant" href="vim9class.html#E1375" name="E1375">E1375</a>&nbsp;<a class="Constant" href="vim9class.html#E1384" name="E1384">E1384</a>&nbsp;<a class="Constant" href="vim9class.html#E1385" name="E1385">E1385</a><br>
To access a class member outside of the class where it is defined, the class<br>
name prefix must be used.&nbsp;&nbsp;A class member cannot be accessed using an object.<br>
<br>
Just like object members the access can be made protected by using an<br>
underscore as the first character in the name, and it can be made public by<br>
prefixing &quot;public&quot;:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;class OtherThing<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static var total: number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# anybody can read, only class can write<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static var _sum: number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # only class can read and write<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public static var result: number&nbsp;&nbsp;# anybody can read and write<br>
&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#class-method" name="class-method">class-method</a><br>
Class methods are also declared with &quot;static&quot;.&nbsp;&nbsp;They can use the class<br>
variables but they have no access to the object variables, they cannot use the<br>
&quot;this&quot; keyword:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class OtherThing<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var size: number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static var totalSize: number</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Clear the total size and return the value it had before.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static def ClearTotalSize(): number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var prev = totalSize<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;totalSize = 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return prev<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
Inside the class the class method can be called by name directly, outside the<br>
class the class name must be prefixed:&nbsp;<span class="Comment">OtherThing.ClearTotalSize()</span>.&nbsp;&nbsp;To use<br>
a super class method in a child class, the class name must be prefixed.<br>
<br>
Just like object methods the access can be made protected by using an<br>
underscore as the first character in the method name:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;class OtherThing<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static def _Foo()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &quot;Foo&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def Bar()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_Foo()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1370" name="E1370">E1370</a><br>
<span class="Todo">Note</span>&nbsp;that constructors cannot be declared as &quot;static&quot;. They are called like a<br>
static but execute as an object method; they have access to &quot;this&quot;.<br>
<br>
To access the class methods and class variables of a super class in an<br>
extended class, the class name prefix should be used just as from anywhere<br>
outside of the defining class:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;vim9script<br>
&nbsp;&nbsp;&nbsp;&nbsp;class Vehicle<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static var nextID: number = 1000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static def GetID(): number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nextID += 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return nextID<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;endclass<br>
&nbsp;&nbsp;&nbsp;&nbsp;class Car extends Vehicle<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var myID: number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def new()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.myID = Vehicle.GetID()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
Class variables and methods are not inherited by a child class.&nbsp;&nbsp;A child class<br>
can declare a static variable or a method with the same name as the one in the<br>
super class.&nbsp;&nbsp;Depending on the class where the member is used the<br>
corresponding class member will be used.&nbsp;&nbsp;The type of the class member in a<br>
child class can be different from that in the super class.<br>
<br>
The double underscore (__) prefix for a class or object method name is<br>
reserved for future use.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#object-final-variable" name="object-final-variable">object-final-variable</a>&nbsp;<a class="Constant" href="vim9class.html#E1409" name="E1409">E1409</a><br>
The&nbsp;<a class="Identifier" href="vim9.html#:final">:final</a>&nbsp;keyword can be used to make a class or object variable a<br>
constant.&nbsp;&nbsp;Examples:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;class A<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final v1 = [1, 2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # final object variable<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public final v2 = {x: 1}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# final object variable<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static final v3 = 'abc'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # final class variable<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public static final v4 = 0z10&nbsp;&nbsp; # final class variable<br>
&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
A final variable can be changed only from a constructor function.&nbsp;&nbsp;Example:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;class A<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final v1: list&lt;number&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def new()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.v1 = [1, 2]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;endclass<br>
&nbsp;&nbsp;&nbsp;&nbsp;var a = A.new()<br>
&nbsp;&nbsp;&nbsp;&nbsp;echo a.v1</div>
<br>
<span class="Todo">Note</span>&nbsp;that the value of a final variable can be changed.&nbsp;&nbsp;Example:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;class A<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public final v1 = [1, 2]<br>
&nbsp;&nbsp;&nbsp;&nbsp;endclass<br>
&nbsp;&nbsp;&nbsp;&nbsp;var a = A.new()<br>
&nbsp;&nbsp;&nbsp;&nbsp;a.v1[0] = 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # OK<br>
&nbsp;&nbsp;&nbsp;&nbsp;a.v1-&gt;add(3)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# OK<br>
&nbsp;&nbsp;&nbsp;&nbsp;a.v1 = [3, 4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Error</div>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1408" name="E1408">E1408</a><br>
Final variables are not supported in an interface.&nbsp;&nbsp;A class or object method<br>
cannot be final.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#object-const-variable" name="object-const-variable">object-const-variable</a><br>
The&nbsp;<a class="Identifier" href="eval.html#:const">:const</a>&nbsp;keyword can be used to make a class or object variable and the<br>
value a constant.&nbsp;&nbsp;Examples:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;class A<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const v1 = [1, 2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # const object variable<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public const v2 = {x: 1}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# const object variable<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static const v3 = 'abc'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # const class variable<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public static const v4 = 0z10&nbsp;&nbsp; # const class variable<br>
&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
A const variable can be changed only from a constructor function. Example:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;class A<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const v1: list&lt;number&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def new()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.v1 = [1, 2]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;endclass<br>
&nbsp;&nbsp;&nbsp;&nbsp;var a = A.new()<br>
&nbsp;&nbsp;&nbsp;&nbsp;echo a.v1</div>
<br>
A const variable and its value cannot be changed.&nbsp;&nbsp;Example:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;class A<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public const v1 = [1, 2]<br>
&nbsp;&nbsp;&nbsp;&nbsp;endclass<br>
&nbsp;&nbsp;&nbsp;&nbsp;var a = A.new()<br>
&nbsp;&nbsp;&nbsp;&nbsp;a.v1[0] = 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Error<br>
&nbsp;&nbsp;&nbsp;&nbsp;a.v1-&gt;add(3)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Error<br>
&nbsp;&nbsp;&nbsp;&nbsp;a.v1 = [3, 4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Error</div>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1410" name="E1410">E1410</a><br>
Const variables are not supported in an interface.&nbsp;&nbsp;A class or object method<br>
cannot be a const.<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<br>
4.&nbsp;&nbsp;Using an abstract class&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#Vim9-abstract-class" name="Vim9-abstract-class">Vim9-abstract-class</a><br>
<br>
An abstract class forms the base for at least one sub-class.&nbsp;&nbsp;In the class<br>
model one often finds that a few classes have the same properties that can be<br>
shared, but a class with these properties does not have enough state to create<br>
an object from.&nbsp;&nbsp;A sub-class must extend the abstract class and add the<br>
missing state and/or methods before it can be used to create objects for.<br>
<br>
For example, a Shape class could store a color and thickness.&nbsp;&nbsp;You cannot<br>
create a Shape object, it is missing the information about what kind of shape<br>
it is.&nbsp;&nbsp;The Shape class functions as the base for a Square and a Triangle<br>
class, for which objects can be created.&nbsp;&nbsp;Example:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abstract class Shape<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var color = Color.Black<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var thickness = 10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class Square extends Shape<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var size: number</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def new(this.size)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class Triangle extends Shape<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var base: number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var height: number</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def new(this.base, this.height)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
An abstract class is defined the same way as a normal class, except that it<br>
does not have any new() method.&nbsp;<a class="Constant" href="vim9class.html#E1359" name="E1359">E1359</a><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#abstract-method" name="abstract-method">abstract-method</a>&nbsp;<a class="Constant" href="vim9class.html#E1371" name="E1371">E1371</a>&nbsp;<a class="Constant" href="vim9class.html#E1372" name="E1372">E1372</a><br>
An abstract method can be defined in an abstract class by using the &quot;abstract&quot;<br>
prefix when defining the method:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abstract class Shape<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; abstract def Draw()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; abstract static def SetColor()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
A static method in an abstract class cannot be an abstract method.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1373" name="E1373">E1373</a><br>
A class extending the abstract class must implement all the abstract methods.<br>
The signature (arguments, argument types and return type) must be exactly the<br>
same.&nbsp;&nbsp;If the return type of a method is a class, then that class or one of<br>
its subclasses can be used in the extended method.&nbsp;&nbsp;Class methods in an<br>
abstract class can also be abstract methods.<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<br>
5.&nbsp;&nbsp;Using an interface&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#Vim9-using-interface" name="Vim9-using-interface">Vim9-using-interface</a><br>
<br>
The example above with Shape, Square and Triangle can be made more useful if<br>
we add a method to compute the surface of the object.&nbsp;&nbsp;For that we create the<br>
interface called HasSurface, which specifies one method Surface() that returns<br>
a number.&nbsp;&nbsp;This example extends the one above:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abstract class Shape<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var color = Color.Black<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var thickness = 10<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interface HasSurface<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def Surface(): number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endinterface</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class Square extends Shape implements HasSurface<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var size: number</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def new(this.size)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enddef</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def Surface(): number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return this.size * this.size<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class Triangle extends Shape implements HasSurface<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var base: number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var height: number</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def new(this.base, this.height)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enddef</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def Surface(): number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return this.base * this.height / 2<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1348" name="E1348">E1348</a>&nbsp;<a class="Constant" href="vim9class.html#E1349" name="E1349">E1349</a>&nbsp;<a class="Constant" href="vim9class.html#E1367" name="E1367">E1367</a>&nbsp;<a class="Constant" href="vim9class.html#E1382" name="E1382">E1382</a>&nbsp;<a class="Constant" href="vim9class.html#E1383" name="E1383">E1383</a><br>
If a class declares to implement an interface, all the items specified in the<br>
interface must appear in the class, with the same types.<br>
<br>
The interface name can be used as a type:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var shapes: list&lt;HasSurface&gt; = [<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Square.new(12),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Triangle.new(8, 15),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for shape in shapes<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo $'the surface is {shape.Surface()}'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endfor</div>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1378" name="E1378">E1378</a>&nbsp;<a class="Constant" href="vim9class.html#E1379" name="E1379">E1379</a>&nbsp;<a class="Constant" href="vim9class.html#E1380" name="E1380">E1380</a>&nbsp;<a class="Constant" href="vim9class.html#E1387" name="E1387">E1387</a><br>
An interface can contain only object methods and read-only object variables.<br>
An interface cannot contain read-write or protected object variables,<br>
protected object methods, class variables and class methods.<br>
<br>
An interface can extend another interface using &quot;extends&quot;.&nbsp;&nbsp;The sub-interface<br>
inherits all the instance variables and methods from the super interface.<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<br>
6.&nbsp;&nbsp;More class details&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#Vim9-class" name="Vim9-class">Vim9-class</a>&nbsp;<a class="Constant" href="vim9class.html#Class" name="Class">Class</a>&nbsp;<a class="Constant" href="vim9class.html#class" name="class">class</a><br>
<br>
<span class="PreProc">Defining a class</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#:class" name=":class">:class</a>&nbsp;<a class="Constant" href="vim9class.html#:endclass" name=":endclass">:endclass</a>&nbsp;<a class="Constant" href="vim9class.html#:abstract" name=":abstract">:abstract</a><br>
A class is defined between&nbsp;<a class="Comment" href="vim9class.html#:class">:class</a>&nbsp;and&nbsp;<a class="Comment" href="vim9class.html#:endclass">:endclass</a>.&nbsp;&nbsp;The whole class is<br>
defined in one script file.&nbsp;&nbsp;It is not possible to add to a class later.<br>
<br>
A class can only be defined in a&nbsp;<a class="Identifier" href="vim9.html#Vim9">Vim9</a>&nbsp;script file.&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1316" name="E1316">E1316</a><br>
A class cannot be defined inside a function.<br>
<br>
It is possible to define more than one class in a script file.&nbsp;&nbsp;Although it<br>
usually is better to export only one main class.&nbsp;&nbsp;It can be useful to define<br>
types, enums and helper classes though.<br>
<br>
The&nbsp;<a class="Comment" href="vim9class.html#:abstract">:abstract</a>&nbsp;keyword may be prefixed and&nbsp;<a class="Comment" href="vim9.html#:export">:export</a>&nbsp;may be used.&nbsp;&nbsp;That gives<br>
these variants:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class ClassName<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;export class ClassName<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abstract class ClassName<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;export abstract class ClassName<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1314" name="E1314">E1314</a><br>
The class name should be CamelCased.&nbsp;&nbsp;It must start with an uppercase letter.<br>
That avoids clashing with builtin types.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1315" name="E1315">E1315</a><br>
After the class name these optional items can be used.&nbsp;&nbsp;Each can appear only<br>
once.&nbsp;&nbsp;They can appear in any order, although this order is recommended:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extends ClassName<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;implements InterfaceName, OtherInterface<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;specifies SomeInterface</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1355" name="E1355">E1355</a>&nbsp;<a class="Constant" href="vim9class.html#E1369" name="E1369">E1369</a><br>
Each variable and method name can be used only once.&nbsp;&nbsp;It is not possible to<br>
define a method with the same name and different type of arguments.&nbsp;&nbsp;It is not<br>
possible to use a public and protected member variable with the same name.&nbsp;&nbsp;A<br>
object variable name used in a super class cannot be reused in a child class.<br>
<br>
<br>
<span class="PreProc">Object Variable Initialization</span><br>
<br>
If the type of a variable is not explicitly specified in a class, then it is<br>
set to &quot;any&quot; during class definition.&nbsp;&nbsp;When an object is instantiated from the<br>
class, then the type of the variable is set.<br>
<br>
The following reserved keyword names cannot be used as an object or class<br>
variable name: &quot;super&quot;, &quot;this&quot;, &quot;true&quot;, &quot;false&quot;, &quot;null&quot;, &quot;null_blob&quot;,<br>
&quot;null_dict&quot;, &quot;null_function&quot;, &quot;null_list&quot;, &quot;null_partial&quot;, &quot;null_string&quot;,<br>
&quot;null_channel&quot; and &quot;null_job&quot;.<br>
<br>
<span class="PreProc">Extending a class</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#extends" name="extends">extends</a><br>
A class can extend one other class.&nbsp;<a class="Constant" href="vim9class.html#E1352" name="E1352">E1352</a>&nbsp;<a class="Constant" href="vim9class.html#E1353" name="E1353">E1353</a>&nbsp;<a class="Constant" href="vim9class.html#E1354" name="E1354">E1354</a><br>
The basic idea is to build on top of an existing class, add properties to it.<br>
<br>
The extended class is called the &quot;base class&quot; or &quot;super class&quot;.&nbsp;&nbsp;The new class<br>
is called the &quot;child class&quot;.<br>
<br>
Object variables from the base class are all taken over by the child class.&nbsp;&nbsp;It<br>
is not possible to override them (unlike some other languages).<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1356" name="E1356">E1356</a>&nbsp;<a class="Constant" href="vim9class.html#E1357" name="E1357">E1357</a>&nbsp;<a class="Constant" href="vim9class.html#E1358" name="E1358">E1358</a><br>
Object methods of the base class can be overruled.&nbsp;&nbsp;The signature (arguments,<br>
argument types and return type) must be exactly the same.&nbsp;&nbsp;If the return type<br>
of a method is a class, then that class or one of its subclasses can be used<br>
in the extended method.&nbsp;&nbsp;The method of the base class can be called by<br>
prefixing &quot;super.&quot;.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1377" name="E1377">E1377</a><br>
The access level of a method (public or protected) in a child class should be<br>
the same as the super class.<br>
<br>
Other object methods of the base class are taken over by the child class.<br>
<br>
Class methods, including methods starting with &quot;new&quot;, can be overruled, like<br>
with object methods.&nbsp;&nbsp;The method on the base class can be called by prefixing<br>
the name of the class (for class methods) or &quot;super.&quot;.<br>
<br>
Unlike other languages, the constructor of the base class does not need to be<br>
invoked.&nbsp;&nbsp;In fact, it cannot be invoked.&nbsp;&nbsp;If some initialization from the base<br>
class also needs to be done in a child class, put it in an object method and<br>
call that method from every constructor().<br>
<br>
If the base class did not specify a new() method then one was automatically<br>
created.&nbsp;&nbsp;This method will not be taken over by the child class.&nbsp;&nbsp;The child<br>
class can define its own new() method, or, if there isn't one, a new() method<br>
will be added automatically.<br>
<br>
<br>
<span class="PreProc">A class implementing an interface</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#implements" name="implements">implements</a>&nbsp;<a class="Constant" href="vim9class.html#E1346" name="E1346">E1346</a>&nbsp;<a class="Constant" href="vim9class.html#E1347" name="E1347">E1347</a>&nbsp;<a class="Constant" href="vim9class.html#E1389" name="E1389">E1389</a><br>
A class can implement one or more interfaces.&nbsp;&nbsp;The &quot;implements&quot; keyword can<br>
only appear once&nbsp;<a class="Constant" href="vim9class.html#E1350" name="E1350">E1350</a>&nbsp;.&nbsp;&nbsp;Multiple interfaces can be specified, separated by<br>
commas.&nbsp;&nbsp;Each interface name can appear only once.&nbsp;<a class="Constant" href="vim9class.html#E1351" name="E1351">E1351</a><br>
<br>
<br>
<span class="PreProc">A class defining an interface</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#specifies" name="specifies">specifies</a><br>
A class can declare its interface, the object variables and methods, with a<br>
named interface.&nbsp;&nbsp;This avoids the need for separately specifying the<br>
interface, which is often done in many languages, especially Java.<br>
<br>
<br>
<span class="PreProc">Items in a class</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1318" name="E1318">E1318</a>&nbsp;<a class="Constant" href="vim9class.html#E1325" name="E1325">E1325</a>&nbsp;<a class="Constant" href="vim9class.html#E1388" name="E1388">E1388</a><br>
Inside a class, in between&nbsp;<a class="Comment" href="vim9class.html#:class">:class</a>&nbsp;and&nbsp;<a class="Comment" href="vim9class.html#:endclass">:endclass</a>, these items can appear:<br>
- An object variable declaration:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var _protectedVariableName: memberType<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var readonlyVariableName: memberType<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public var readwriteVariableName: memberType</div>
- A class variable declaration:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static var _protectedClassVariableName: memberType<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static var readonlyClassVariableName: memberType<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static var public readwriteClassVariableName: memberType</div>
- A constructor method:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def new(arguments)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def newName(arguments)</div>
- A class method:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static def SomeMethod(arguments)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static def _ProtectedMethod(arguments)</div>
- An object method:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def SomeMethod(arguments)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def _ProtectedMethod(arguments)</div>
<br>
For the object variable the type must be specified.&nbsp;&nbsp;The best way is to do<br>
this explicitly with &quot;:&nbsp;<span class="Special">{type}</span>&quot;.&nbsp;&nbsp;For simple types you can also use an<br>
initializer, such as &quot;= 123&quot;, and Vim will see that the type is a number.<br>
Avoid doing this for more complex types and when the type will be incomplete.<br>
For example:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var nameList = []</div>
This specifies a list, but the item type is unknown.&nbsp;&nbsp;Better use:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var nameList: list&lt;string&gt;</div>
The initialization isn't needed, the list is empty by default.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1330" name="E1330">E1330</a><br>
Some types cannot be used, such as &quot;void&quot;, &quot;null&quot; and &quot;v:none&quot;.<br>
<br>
<br>
<span class="PreProc">Defining an interface</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#:interface" name=":interface">:interface</a>&nbsp;<a class="Constant" href="vim9class.html#:endinterface" name=":endinterface">:endinterface</a><br>
An interface is defined between&nbsp;<a class="Comment" href="vim9class.html#:interface">:interface</a>&nbsp;and&nbsp;<a class="Comment" href="vim9class.html#:endinterface">:endinterface</a>.&nbsp;&nbsp;It may be<br>
prefixed with&nbsp;<a class="Comment" href="vim9.html#:export">:export</a>:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interface InterfaceName<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endinterface</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;export interface InterfaceName<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endinterface</div>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1344" name="E1344">E1344</a><br>
An interface can declare object variables, just like in a class but without<br>
any initializer.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1345" name="E1345">E1345</a><br>
An interface can declare methods with&nbsp;<a class="Comment" href="vim9.html#:def">:def</a>, including the arguments and<br>
return type, but without the body and without&nbsp;<a class="Comment" href="vim9.html#:enddef">:enddef</a>.&nbsp;&nbsp;Example:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;interface HasSurface<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var size: number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; def Surface(): number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endinterface</div>
<br>
An interface name must start with an uppercase letter.&nbsp;<a class="Constant" href="vim9class.html#E1343" name="E1343">E1343</a><br>
The &quot;Has&quot; prefix can be used to make it easier to guess this is an interface<br>
name, with a hint about what it provides.<br>
An interface can only be defined in a&nbsp;<a class="Identifier" href="vim9.html#Vim9">Vim9</a>&nbsp;script file.&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1342" name="E1342">E1342</a><br>
An interface cannot &quot;implement&quot; another interface but it can &quot;extend&quot; another<br>
interface.&nbsp;<a class="Constant" href="vim9class.html#E1381" name="E1381">E1381</a><br>
<br>
<br>
<span class="PreProc">null object</span><br>
<br>
When a variable is declared to have the type of an object, but it is not<br>
initialized, the value is null.&nbsp;&nbsp;When trying to use this null object Vim often<br>
does not know what class was supposed to be used.&nbsp;&nbsp;Vim then cannot check if<br>
a variable name is correct and you will get an &quot;Using a null object&quot; error,<br>
even when the variable name is invalid.&nbsp;<a class="Constant" href="vim9class.html#E1360" name="E1360">E1360</a>&nbsp;<a class="Constant" href="vim9class.html#E1362" name="E1362">E1362</a><br>
<br>
<br>
<span class="PreProc">Default constructor</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#default-constructor" name="default-constructor">default-constructor</a><br>
In case you define a class without a new() method, one will be automatically<br>
defined.&nbsp;&nbsp;This default constructor will have arguments for all the object<br>
variables, in the order they were specified.&nbsp;&nbsp;Thus if your class looks like:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class AutoNew<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var name: string<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var age: number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var gender: Gender<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
Then the default constructor will be:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def new(this.name = v:none, this.age = v:none, this.gender = v:none)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddef</div>
<br>
The &quot;= v:none&quot; default values make the arguments optional.&nbsp;&nbsp;Thus you can also<br>
call&nbsp;<a class="Comment" href="vim9class.html#new()">new()</a>&nbsp;without any arguments.&nbsp;&nbsp;No assignment will happen and the default<br>
value for the object variables will be used.&nbsp;&nbsp;This is a more useful example,<br>
with default values:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class TextPosition<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var lnum: number = 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var col: number = 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
If you want the constructor to have mandatory arguments, you need to write it<br>
yourself.&nbsp;&nbsp;For example, if for the AutoNew class above you insist on getting<br>
the name, you can define the constructor like this:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def new(this.name, this.age = v:none, this.gender = v:none)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddef</div>
<br>
When using the default new() method, if the order of the object variables in<br>
the class is changed later, then all the callers of the default new() method<br>
needs to change.&nbsp;&nbsp;To avoid this, the new() method can be explicitly defined<br>
without any arguments.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1328" name="E1328">E1328</a><br>
<span class="Todo">Note</span>&nbsp;that you cannot use another default value than &quot;v:none&quot; here.&nbsp;&nbsp;If you<br>
want to initialize the object variables, do it where they are declared.&nbsp;&nbsp;This<br>
way you only need to look in one place for the default values.<br>
<br>
All object variables will be used in the default constructor, including<br>
protected access ones.<br>
<br>
If the class extends another one, the object variables of that class will come<br>
first.<br>
<br>
<br>
<span class="PreProc">Multiple constructors</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#multiple-constructors" name="multiple-constructors">multiple-constructors</a><br>
Normally a class has just one new() constructor.&nbsp;&nbsp;In case you find that the<br>
constructor is often called with the same arguments you may want to simplify<br>
your code by putting those arguments into a second constructor method.&nbsp;&nbsp;For<br>
example, if you tend to use the color black a lot:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def new(this.garment, this.color, this.size)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var pants = new(Garment.pants, Color.black, &quot;XL&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var shirt = new(Garment.shirt, Color.black, &quot;XL&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var shoes = new(Garment.shoes, Color.black, &quot;45&quot;)</div>
<br>
Instead of repeating the color every time you can add a constructor that<br>
includes it:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def newBlack(this.garment, this.size)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.color = Color.black<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var pants = newBlack(Garment.pants, &quot;XL&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var shirt = newBlack(Garment.shirt, &quot;XL&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var shoes = newBlack(Garment.shoes, &quot;9.5&quot;)</div>
<br>
<span class="Todo">Note</span>&nbsp;that the method name must start with &quot;new&quot;.&nbsp;&nbsp;If there is no method called<br>
&quot;new()&quot; then the default constructor is added, even though there are other<br>
constructor methods.<br>
<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<br>
7.&nbsp;&nbsp;Type definition&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#Vim9-type" name="Vim9-type">Vim9-type</a>&nbsp;<a class="Constant" href="vim9class.html#:type" name=":type">:type</a><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1393" name="E1393">E1393</a>&nbsp;<a class="Constant" href="vim9class.html#E1395" name="E1395">E1395</a>&nbsp;<a class="Constant" href="vim9class.html#E1396" name="E1396">E1396</a>&nbsp;<a class="Constant" href="vim9class.html#E1397" name="E1397">E1397</a>&nbsp;<a class="Constant" href="vim9class.html#E1398" name="E1398">E1398</a><br>
A type definition is giving a name to a type specification.&nbsp;&nbsp;This is also<br>
known as a &quot;type alias&quot;.&nbsp;&nbsp;The type alias can be used wherever a built-in type<br>
can be used.&nbsp;&nbsp;Example:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;type ListOfStrings = list&lt;string&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;var s: ListOfStrings = ['a', 'b']</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;def ProcessStr(str: ListOfStrings): ListOfStrings<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return str<br>
&nbsp;&nbsp;&nbsp;&nbsp;enddef<br>
&nbsp;&nbsp;&nbsp;&nbsp;echo ProcessStr(s)</div>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1394" name="E1394">E1394</a><br>
A type alias name must start with an upper case character.&nbsp;&nbsp;Only existing<br>
types can be aliased.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1399" name="E1399">E1399</a><br>
A type alias can be created only at the script level and not inside a<br>
function.&nbsp;&nbsp;A type alias can be exported and used across scripts.<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#E1400" name="E1400">E1400</a>&nbsp;<a class="Constant" href="vim9class.html#E1401" name="E1401">E1401</a>&nbsp;<a class="Constant" href="vim9class.html#E1402" name="E1402">E1402</a>&nbsp;<a class="Constant" href="vim9class.html#E1403" name="E1403">E1403</a>&nbsp;<a class="Constant" href="vim9class.html#E1407" name="E1407">E1407</a><br>
A type alias cannot be used as an expression.&nbsp;&nbsp;A type alias cannot be used in<br>
the left-hand-side of an assignment.<br>
<br>
For a type alias name, the&nbsp;<a class="Identifier" href="builtin.html#typename()">typename()</a>&nbsp;function returns the type that is<br>
aliased:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;type ListOfStudents = list&lt;dict&lt;any&gt;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;echo typename(ListOfStudents)<br>
&nbsp;&nbsp;&nbsp;&nbsp;typealias&lt;list&lt;dict&lt;any&gt;&gt;&gt;</div>
<br>
<span class="PreProc">==============================================================================</span><br>
<br>
8.&nbsp;&nbsp;Enum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#Vim9-enum" name="Vim9-enum">Vim9-enum</a>&nbsp;<a class="Constant" href="vim9class.html#:enum" name=":enum">:enum</a>&nbsp;<a class="Constant" href="vim9class.html#:endenum" name=":endenum">:endenum</a><br>
<br>
<span class="Special">{not implemented yet}</span><br>
<br>
An enum is a type that can have one of a list of values.&nbsp;&nbsp;Example:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:enum Color<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;White<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Red<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Green<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Blue<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Black<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:endenum</div>
<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<br>
9.&nbsp;&nbsp;Rationale<br>
<br>
Most of the choices for&nbsp;<a class="Identifier" href="vim9.html#Vim9">Vim9</a>&nbsp;classes come from popular and recently<br>
developed languages, such as Java, TypeScript and Dart.&nbsp;&nbsp;The syntax has been<br>
made to fit with the way Vim script works, such as using&nbsp;<a class="Comment" href="vim9class.html#:endclass">endclass</a>&nbsp;instead of<br>
using curly braces around the whole class.<br>
<br>
Some common constructs of object-oriented languages were chosen very long ago<br>
when this kind of programming was still new, and later found to be<br>
sub-optimal.&nbsp;&nbsp;By this time those constructs were widely used and changing them<br>
was not an option.&nbsp;&nbsp;In Vim we do have the freedom to make different choices,<br>
since classes are completely new.&nbsp;&nbsp;We can make the syntax simpler and more<br>
consistent than what &quot;old&quot; languages use.&nbsp;&nbsp;Without diverting too much, it<br>
should still mostly look like what you know from existing languages.<br>
<br>
Some recently developed languages add all kinds of fancy features that we<br>
don't need for Vim.&nbsp;&nbsp;But some have nice ideas that we do want to use.<br>
Thus we end up with a base of what is common in popular languages, dropping<br>
what looks like a bad idea, and adding some nice features that are easy to<br>
understand.<br>
<br>
The main rules we use to make decisions:<br>
- Keep it simple.<br>
- No surprises, mostly do what other languages are doing.<br>
- Avoid mistakes from the past.<br>
- Avoid the need for the script writer to consult the help to understand how<br>
&nbsp;&nbsp;things work, most things should be obvious.<br>
- Keep it consistent.<br>
- Aim at an average size plugin, not at a huge project.<br>
<br>
<br>
<span class="PreProc">Using new() for the constructor</span><br>
<br>
Many languages use the class name for the constructor method.&nbsp;&nbsp;A disadvantage<br>
is that quite often this is a long name.&nbsp;&nbsp;And when changing the class name all<br>
constructor methods need to be renamed.&nbsp;&nbsp;Not a big deal, but still a<br>
disadvantage.<br>
<br>
Other languages, such as TypeScript, use a specific name, such as<br>
&quot;constructor()&quot;.&nbsp;&nbsp;That seems better.&nbsp;&nbsp;However, using &quot;new&quot; or &quot;new()&quot; to<br>
create a new object has no obvious relation with &quot;constructor()&quot;.<br>
<br>
For&nbsp;<a class="Identifier" href="vim9.html#Vim9">Vim9</a>&nbsp;script using the same method name for all constructors seemed like<br>
the right choice, and by calling it new() the relation between the caller and<br>
the method being called is obvious.<br>
<br>
<br>
<span class="PreProc">No overloading of the constructor</span><br>
<br>
In Vim script, both legacy and&nbsp;<a class="Identifier" href="vim9.html#Vim9">Vim9</a>&nbsp;script, there is no overloading of<br>
methods.&nbsp;&nbsp;That means it is not possible to use the same method name with<br>
different types of arguments.&nbsp;&nbsp;Therefore there also is only one new()<br>
constructor.<br>
<br>
With&nbsp;<a class="Identifier" href="vim9.html#Vim9">Vim9</a>&nbsp;script it would be possible to support overloading, since<br>
arguments are typed.&nbsp;&nbsp;However, this gets complicated very quickly.&nbsp;&nbsp;Looking at<br>
a new() call one has to inspect the types of the arguments to know which of<br>
several new() methods is actually being called.&nbsp;&nbsp;And that can require<br>
inspecting quite a bit of code.&nbsp;&nbsp;For example, if one of the arguments is the<br>
return value of a method, you need to find that method to see what type it is<br>
returning.<br>
<br>
Instead, every constructor has to have a different name, starting with &quot;new&quot;.<br>
That way multiple constructors with different arguments are possible, while it<br>
is very easy to see which constructor is being used.&nbsp;&nbsp;And the type of<br>
arguments can be properly checked.<br>
<br>
<br>
<span class="PreProc">No overloading of methods</span><br>
<br>
Same reasoning as for the constructor: It is often not obvious what type<br>
arguments have, which would make it difficult to figure out what method is<br>
actually being called.&nbsp;&nbsp;Better just give the methods a different name, then<br>
type checking will make sure it works as you intended.&nbsp;&nbsp;This rules out<br>
polymorphism, which we don't really need anyway.<br>
<br>
<br>
<span class="PreProc">Single inheritance and interfaces</span><br>
<br>
Some languages support multiple inheritance.&nbsp;&nbsp;Although that can be useful in<br>
some cases, it makes the rules of how a class works quite complicated.<br>
Instead, using interfaces to declare what is supported is much simpler.&nbsp;&nbsp;The<br>
very popular Java language does it this way, and it should be good enough for<br>
Vim.&nbsp;&nbsp;The &quot;keep it simple&quot; rule applies here.<br>
<br>
Explicitly declaring that a class supports an interface makes it easy to see<br>
what a class is intended for.&nbsp;&nbsp;It also makes it possible to do proper type<br>
checking.&nbsp;&nbsp;When an interface is changed any class that declares to implement<br>
it will be checked if that change was also changed.&nbsp;&nbsp;The mechanism to assume a<br>
class implements an interface just because the methods happen to match is<br>
brittle and leads to obscure problems, let's not do that.<br>
<br>
<br>
<span class="PreProc">Using &quot;this.variable&quot; everywhere</span><br>
<br>
The object variables in various programming languages can often be accessed in<br>
different ways, depending on the location.&nbsp;&nbsp;Sometimes &quot;this.&quot; has to be<br>
prepended to avoid ambiguity.&nbsp;&nbsp;They are usually declared without &quot;this.&quot;.<br>
That is quite inconsistent and sometimes confusing.<br>
<br>
A very common issue is that in the constructor the arguments use the same name<br>
as the object variable.&nbsp;&nbsp;Then for these variables &quot;this.&quot; needs to be prefixed<br>
in the body, while for other variables this is not needed and often omitted.<br>
This leads to a mix of variables with and without &quot;this.&quot;, which is<br>
inconsistent.<br>
<br>
For&nbsp;<a class="Identifier" href="vim9.html#Vim9">Vim9</a>&nbsp;classes the &quot;this.&quot; prefix is always used.&nbsp;&nbsp;Also for declaring the<br>
variables.&nbsp;&nbsp;Simple and consistent.&nbsp;&nbsp;When looking at the code inside a class<br>
it's also directly clear which variable references are object variables and<br>
which aren't.<br>
<br>
<br>
<span class="PreProc">Using class variables</span><br>
<br>
Using &quot;static variable&quot; to declare a class variable is very common, nothing<br>
new here.&nbsp;&nbsp;In&nbsp;<a class="Identifier" href="vim9.html#Vim9">Vim9</a>&nbsp;script these can be accessed directly by their name.<br>
Very much like how a script-local variable can be used in a method.&nbsp;&nbsp;Since<br>
object variables are always accessed with &quot;this.&quot; prepended, it's also quickly<br>
clear what kind of variable it is.<br>
<br>
TypeScript prepends the class name before the class variable name, also inside<br>
the class.&nbsp;&nbsp;This has two problems: The class name can be rather long, taking<br>
up quite a bit of space, and when the class is renamed all these places need<br>
to be changed too.<br>
<br>
<br>
<span class="PreProc">Declaring object and class variables</span><br>
<br>
The main choice is whether to use &quot;var&quot; as with variable declarations.<br>
TypeScript does not use it:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class Point {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x: number;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y = 0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div>
<br>
Following that Vim object variables could be declared like this:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class Point<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.x: number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.y = 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
Some users pointed out that this looks more like an assignment than a<br>
declaration.&nbsp;&nbsp;Adding &quot;var&quot; changes that:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class Point<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var x: number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var y = 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
We also need to be able to declare class variables using the &quot;static&quot; keyword.<br>
There we can also choose to leave out &quot;var&quot;:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class Point<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var x: number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static count = 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
Or do use it, before &quot;static&quot;:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class Point<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var x: number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var static count = 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
Or after &quot;static&quot;:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class Point<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var x: number<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static var count = 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endclass</div>
<br>
This is more in line with &quot;static def Func()&quot;.<br>
<br>
There is no clear preference whether to use &quot;var&quot; or not.&nbsp;&nbsp;The two main<br>
reasons to leave it out are:<br>
1. TypeScript and other popular languages do not use it.<br>
2. Less clutter.<br>
<br>
However, it is more common for languages to reuse their general variable and<br>
function declaration syntax for class/object variables and methods.&nbsp;&nbsp;Vim9 also<br>
reuses the general function declaration syntax for methods.&nbsp;&nbsp;So, for the sake<br>
of consistency, we require &quot;var&quot; in these declarations.<br>
<br>
<br>
<span class="PreProc">Using &quot;ClassName.new()&quot; to construct an object</span><br>
<br>
Many languages use the &quot;new&quot; operator to create an object, which is actually<br>
kind of strange, since the constructor is defined as a method with arguments,<br>
not a command.&nbsp;&nbsp;TypeScript also has the &quot;new&quot; keyword, but the method is<br>
called &quot;constructor()&quot;, it is hard to see the relation between the two.<br>
<br>
In&nbsp;<a class="Identifier" href="vim9.html#Vim9">Vim9</a>&nbsp;script the constructor method is called new(), and it is invoked as<br>
new(), simple and straightforward.&nbsp;&nbsp;Other languages use &quot;new ClassName()&quot;,<br>
while there is no ClassName() method, it's a method by another name in the<br>
class called ClassName.&nbsp;&nbsp;Quite confusing.<br>
<br>
<br>
<span class="PreProc">Vim9class access modes</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Constant" href="vim9class.html#vim9-access-modes" name="vim9-access-modes">vim9-access-modes</a><br>
The variable access modes, and their meaning, supported by Vim9class are<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="vim9class.html#public-variable">public-variable</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; read and write from anywhere<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="vim9class.html#read-only-variable">read-only-variable</a>&nbsp;&nbsp;&nbsp;&nbsp;read from anywhere, write from inside the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class and sub-classes<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="Identifier" href="vim9class.html#protected-variable">protected-variable</a>&nbsp;&nbsp;&nbsp;&nbsp;read and write from inside the class and<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub-classes<br>
<br>
The method access modes are similar, but without the read-only mode.<br>
<br>
<br>
<span class="PreProc">Default read access to object variables</span><br>
<br>
Some users will remark that the access rules for object variables are<br>
asymmetric.&nbsp;&nbsp;Well, that is intentional.&nbsp;&nbsp;Changing a value is a very different<br>
action than reading a value.&nbsp;&nbsp;The read operation has no side effects, it can<br>
be done any number of times without affecting the object.&nbsp;&nbsp;Changing the value<br>
can have many side effects, and even have a ripple effect, affecting other<br>
objects.<br>
<br>
When adding object variables one usually doesn't think much about this, just<br>
get the type right.&nbsp;&nbsp;And normally the values are set in the new() method.<br>
Therefore defaulting to read access only &quot;just works&quot; in most cases.&nbsp;&nbsp;And when<br>
directly writing you get an error, which makes you wonder if you actually want<br>
to allow that.&nbsp;&nbsp;This helps writing code with fewer mistakes.<br>
<br>
<br>
<span class="PreProc">Making object variables protected with an underscore</span><br>
<br>
When an object variable is protected, it can only be read and changed inside<br>
the class (and in sub-classes), then it cannot be used outside of the class.<br>
Prepending an underscore is a simple way to make that visible.&nbsp;&nbsp;Various<br>
programming languages have this as a recommendation.<br>
<br>
In case you change your mind and want to make the object variable accessible<br>
outside of the class, you will have to remove the underscore everywhere.<br>
Since the name only appears in the class (and sub-classes) they will be easy<br>
to find and change.<br>
<br>
The other way around is much harder: you can easily prepend an underscore to<br>
the object variable inside the class to make it protected, but any usage<br>
elsewhere you will have to track down and change.&nbsp;&nbsp;You may have to make it a<br>
&quot;set&quot; method call.&nbsp;&nbsp;This reflects the real world problem that taking away<br>
access requires work to be done for all places where that access exists.<br>
<br>
An alternative would have been using the &quot;protected&quot; keyword, just like<br>
&quot;public&quot; changes the access in the other direction.&nbsp;&nbsp;Well, that's just to<br>
reduce the number of keywords.<br>
<br>
<br>
<span class="PreProc">No private object variables</span><br>
<br>
Some languages provide several ways to control access to object variables.<br>
The most known is &quot;protected&quot;, and the meaning varies from language to<br>
language.&nbsp;&nbsp;Others are &quot;shared&quot;, &quot;private&quot;, &quot;package&quot; and even &quot;friend&quot;.<br>
<br>
These rules make life more difficult.&nbsp;&nbsp;That can be justified in projects where<br>
many people work on the same, complex code where it is easy to make mistakes.<br>
Especially when refactoring or other changes to the class model.<br>
<br>
The Vim scripts are expected to be used in a plugin, with just one person or a<br>
small team working on it.&nbsp;&nbsp;Complex rules then only make it more complicated,<br>
the extra safety provided by the rules isn't really needed.&nbsp;&nbsp;Let's just keep<br>
it simple and not specify access details.<br>
<br>
<br>
<span class="PreProc">==============================================================================</span><br>
<br>
10. To be done later<br>
<br>
Can a newSomething() constructor invoke another constructor?&nbsp;&nbsp;If yes, what are<br>
the restrictions?<br>
<br>
Thoughts:<br>
- Generics for a class:&nbsp;<span class="Comment">class &lt;Tkey, Tentry&gt;</span><br>
- Generics for a function:&nbsp;<span class="Comment">def &lt;Tkey&gt; GetLast(key: Tkey)</span><br>
- Mixins: not sure if that is useful, leave out for simplicity.<br>
<br>
Some things that look like good additions:<br>
- For testing: Mock mechanism<br>
<br>
An important class to be provided is &quot;Promise&quot;.&nbsp;&nbsp;Since Vim is single<br>
threaded, connecting asynchronous operations is a natural way of allowing<br>
plugins to do their work without blocking the user.&nbsp;&nbsp;It's a uniform way to<br>
invoke callbacks and handle timeouts and errors.<br>
<br>
<br>
&nbsp;vim:tw=78:ts=8:noet:ft=help:norl:<br>
</div>
